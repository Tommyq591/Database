DELIMITER $$

CREATE TRIGGER before_insert_artist
BEFORE INSERT ON artists
FOR EACH ROW
BEGIN
    DECLARE duplicate_count INT;
    SELECT COUNT(*) INTO duplicate_count 
    FROM artists 
    WHERE artist_name = NEW.artist_name;

    IF duplicate_count > 0 THEN
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'Artist name already exists!';
    END IF;
END$$

DELIMITER;

DELIMITER $$

CREATE TRIGGER after_update_concert
AFTER UPDATE ON concerts
FOR EACH ROW
BEGIN
    IF OLD.location <> NEW.location THEN
        UPDATE tickets
        SET ticket_price = ticket_price * 1.10
        WHERE ticket_id IN (
            SELECT ticket_id 
            FROM ticket_concert 
            WHERE concert_id = NEW.concert_id
        );
    END IF;
END$$

DELIMITER ;
